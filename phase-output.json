{
  "signature_schema_version": "2.0",
  "project": "maatify/security-guard",
  "generated_at": "2025-12-08T16:45:00+02:00",
  "phases": [
    {
      "phase_id": "phase1",
      "title": "Environment Setup",
      "version": "1.0.0",
      "status": "completed",
      "date": "2025-12-01",
      "summary": "Initial environment setup including Composer initialization, autoloading configuration, PHPUnit bootstrap, and documentation scaffolding.",
      "changes": {
        "added": [
          "composer.json",
          ".env.example",
          "tests/bootstrap.php",
          "phpunit.xml.dist",
          "README.md",
          "docs/README.full.md"
        ],
        "updated": [],
        "removed": []
      },
      "tests_result": {
        "fake": "passed",
        "real": "not_applicable"
      },
      "coverage": "not_applicable",
      "documentation_files": [
        "README.md",
        "docs/README.full.md"
      ],
      "reflection": {
        "only_modified_classes": false,
        "details": []
      },
      "examples": {
        "present": false,
        "reason": "Phase 1 initializes project environment and infrastructure; no application logic or classes exist at this stage."
      }
    },
    {
      "phase_id": "phase2",
      "title": "Core Architecture & DTOs",
      "version": "1.0.1",
      "status": "completed",
      "date": "2025-12-08",
      "summary": "Introduced immutable DTOs for login attempts and security blocks, defined BlockTypeEnum, and established the unified SecurityGuardDriverInterface as the required contract for all storage drivers.",
      "changes": {
        "added": [
          "src/DTO/LoginAttemptDTO.php",
          "src/DTO/SecurityBlockDTO.php",
          "src/Enums/BlockTypeEnum.php",
          "src/Contracts/SecurityGuardDriverInterface.php",
          "tests/DTO/LoginAttemptDTOTest.php",
          "tests/DTO/SecurityBlockDTOTest.php",
          "tests/DTO/BlockTypeEnumTest.php",
          "tests/Contracts/SecurityGuardDriverInterfaceTest.php",
          "docs/phases/README.phase2.md"
        ],
        "updated": [
          "api-map.json",
          "docs/README.full.md",
          "README.md",
          "CHANGELOG.md"
        ],
        "removed": []
      },
      "tests_result": {
        "fake": "passed",
        "real": "not_applicable"
      },
      "coverage": "100%",
      "documentation_files": [
        "docs/phases/README.phase2.md",
        "docs/README.full.md",
        "README.md",
        "CHANGELOG.md"
      ],
      "reflection": {
        "only_modified_classes": true,
        "details": [
          {
            "class": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO",
            "type": "class",
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "static": false,
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  },
                  {
                    "name": "occurredAt",
                    "type": "int"
                  },
                  {
                    "name": "context",
                    "type": "array<string,mixed>"
                  }
                ]
              },
              {
                "name": "now",
                "visibility": "public",
                "static": true,
                "return_type": "self",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  },
                  {
                    "name": "context",
                    "type": "array<string,mixed>"
                  }
                ]
              },
              {
                "name": "jsonSerialize",
                "visibility": "public",
                "static": false,
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO",
            "type": "class",
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "static": false,
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  },
                  {
                    "name": "type",
                    "type": "Maatify\\SecurityGuard\\Enums\\BlockTypeEnum"
                  },
                  {
                    "name": "expiresAt",
                    "type": "int"
                  },
                  {
                    "name": "createdAt",
                    "type": "int"
                  }
                ]
              },
              {
                "name": "getRemainingSeconds",
                "visibility": "public",
                "static": false,
                "return_type": "int",
                "arguments": []
              },
              {
                "name": "isExpired",
                "visibility": "public",
                "static": false,
                "return_type": "bool",
                "arguments": []
              },
              {
                "name": "jsonSerialize",
                "visibility": "public",
                "static": false,
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Enums\\BlockTypeEnum",
            "type": "enum",
            "cases": [
              "AUTO",
              "MANUAL",
              "SYSTEM"
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Contracts\\SecurityGuardDriverInterface",
            "type": "interface",
            "methods": [
              {
                "name": "recordFailure",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "resetAttempts",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getActiveBlock",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getRemainingBlockSeconds",
                "visibility": "public",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "block",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "unblock",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "cleanup",
                "visibility": "public",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "getStats",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              },
              {
                "name": "isBlocked",
                "visibility": "public",
                "return_type": "bool",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              }
            ]
          }
        ]
      },
      "examples": {
        "present": false,
        "reason": "DTOs and interface contracts do not represent executable logic; examples become meaningful starting Phase 3."
      }
    },
    {
      "phase_id": "phase3",
      "title": "Unified Driver Implementations",
      "version": "1.0.2",
      "status": "completed",
      "date": "2025-12-09",
      "summary": "Implemented all real storage drivers (MySQL PDO, MySQL DBAL, Redis, MongoDB) using maatify/data-adapters only. Added AbstractSecurityGuardDriver and RedisClientProxy. Introduced SecurityGuardService, IdentifierStrategyInterface, and SecurityGuardResolver. Phase 3 represents the first fully functional end-to-end Security Guard engine.",
      "changes": {
        "added": [
          "src/Drivers/AbstractSecurityGuardDriver.php",
          "src/Drivers/Support/RedisClientProxy.php",
          "src/Drivers/RedisSecurityGuard.php",
          "src/Drivers/MySQL/MySQLSecurityGuard.php",
          "src/Drivers/MySQL/PdoMySQLDriver.php",
          "src/Drivers/MySQL/DbalMySQLDriver.php",
          "src/Drivers/MySQL/Contracts/MySQLDriverInterface.php",
          "src/Drivers/Mongo/MongoSecurityGuard.php",
          "src/Identifier/Contracts/IdentifierStrategyInterface.php",
          "src/Identifier/DefaultIdentifierStrategy.php",
          "src/Resolver/SecurityGuardResolver.php",
          "src/Service/SecurityGuardService.php"
        ],
        "updated": [
          "src/DTO/LoginAttemptDTO.php",
          "src/DTO/SecurityBlockDTO.php"
        ],
        "removed": []
      },
      "tests_result": {
        "fake": "passed",
        "real": "passed"
      },
      "coverage": "92%",
      "documentation_files": [
        "docs/phases/README.phase3.md"
      ],
      "reflection": {
        "only_modified_classes": true,
        "details": [
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\AbstractSecurityGuardDriver",
            "type": "abstract",
            "methods": [
              {
                "name": "makeIdentifier",
                "visibility": "protected",
                "static": false,
                "return_type": "string",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "encodeBlock",
                "visibility": "protected",
                "static": false,
                "return_type": "array<string,mixed>",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "decodeBlock",
                "visibility": "protected",
                "static": false,
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "payload",
                    "type": "array<string,mixed>"
                  }
                ]
              },
              {
                "name": "now",
                "visibility": "protected",
                "static": true,
                "return_type": "int",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\MySQL\\Contracts\\MySQLDriverInterface",
            "type": "interface",
            "methods": [
              {
                "name": "recordFailure",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "resetAttempts",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getActiveBlock",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getRemainingBlockSeconds",
                "visibility": "public",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "block",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "unblock",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "cleanup",
                "visibility": "public",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "getStats",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\MySQL\\PdoMySQLDriver",
            "type": "class",
            "implements": [
              "Maatify\\SecurityGuard\\Drivers\\MySQL\\Contracts\\MySQLDriverInterface"
            ],
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  }
                ]
              },
              {
                "name": "recordFailure",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "resetAttempts",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getActiveBlock",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getRemainingBlockSeconds",
                "visibility": "public",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "block",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "unblock",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "cleanup",
                "visibility": "public",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "getStats",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\MySQL\\DbalMySQLDriver",
            "type": "class",
            "implements": [
              "Maatify\\SecurityGuard\\Drivers\\MySQL\\Contracts\\MySQLDriverInterface"
            ],
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  }
                ]
              },
              {
                "name": "recordFailure",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "resetAttempts",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getActiveBlock",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getRemainingBlockSeconds",
                "visibility": "public",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "block",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "unblock",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "cleanup",
                "visibility": "public",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "getStats",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\MySQL\\MySQLSecurityGuard",
            "type": "class",
            "extends": "Maatify\\SecurityGuard\\Drivers\\AbstractSecurityGuardDriver",
            "implements": [
              "Maatify\\SecurityGuard\\Contracts\\SecurityGuardDriverInterface"
            ],
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  },
                  {
                    "name": "strategy",
                    "type": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
                  }
                ]
              },
              {
                "name": "doRecordFailure",
                "visibility": "protected",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "doResetAttempts",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetActiveBlock",
                "visibility": "protected",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetRemainingBlockSeconds",
                "visibility": "protected",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doBlock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "doUnblock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doCleanup",
                "visibility": "protected",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "doGetStats",
                "visibility": "protected",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\Mongo\\MongoSecurityGuard",
            "type": "class",
            "extends": "Maatify\\SecurityGuard\\Drivers\\AbstractSecurityGuardDriver",
            "implements": [
              "Maatify\\SecurityGuard\\Contracts\\SecurityGuardDriverInterface"
            ],
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  },
                  {
                    "name": "strategy",
                    "type": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
                  }
                ]
              },
              {
                "name": "doRecordFailure",
                "visibility": "protected",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "attempt",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "doResetAttempts",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetActiveBlock",
                "visibility": "protected",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetRemainingBlockSeconds",
                "visibility": "protected",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doBlock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "block",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "doUnblock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doCleanup",
                "visibility": "protected",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "doGetStats",
                "visibility": "protected",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\Support\\RedisClientProxy",
            "type": "class",
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "driver",
                    "type": "Redis|Predis\\Client"
                  }
                ]
              },
              {
                "name": "incr",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "hGet",
                "visibility": "public",
                "return_type": "string|null",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  },
                  {
                    "name": "field",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "hSet",
                "visibility": "public",
                "return_type": "bool|int",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  },
                  {
                    "name": "field",
                    "type": "string"
                  },
                  {
                    "name": "value",
                    "type": "string|int"
                  }
                ]
              },
              {
                "name": "hDel",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  },
                  {
                    "name": "field",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "hGetAll",
                "visibility": "public",
                "return_type": "array<string,string>",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "hMSet",
                "visibility": "public",
                "return_type": "bool",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  },
                  {
                    "name": "data",
                    "type": "array<string,int|string>"
                  }
                ]
              },
              {
                "name": "expire",
                "visibility": "public",
                "return_type": "bool",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  },
                  {
                    "name": "seconds",
                    "type": "int"
                  }
                ]
              },
              {
                "name": "ttl",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "del",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "key",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "info",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Drivers\\Mongo\\MongoSecurityGuard",
            "type": "class",
            "extends": "Maatify\\SecurityGuard\\Drivers\\AbstractSecurityGuardDriver",
            "implements": [
              "Maatify\\SecurityGuard\\Contracts\\SecurityGuardDriverInterface"
            ],
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  },
                  {
                    "name": "strategy",
                    "type": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
                  }
                ]
              },
              {
                "name": "doRecordFailure",
                "visibility": "protected",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "attempt",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "doResetAttempts",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetActiveBlock",
                "visibility": "protected",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doGetRemainingBlockSeconds",
                "visibility": "protected",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doBlock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "block",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "doUnblock",
                "visibility": "protected",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "doCleanup",
                "visibility": "protected",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "doGetStats",
                "visibility": "protected",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface",
            "type": "interface",
            "methods": [
              {
                "name": "makeId",
                "visibility": "public",
                "return_type": "string",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Identifier\\DefaultIdentifierStrategy",
            "type": "class",
            "implements": [
              "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
            ],
            "methods": [
              {
                "name": "makeId",
                "visibility": "public",
                "return_type": "string",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Resolver\\SecurityGuardResolver",
            "type": "class",
            "methods": [
              {
                "name": "resolve",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\Contracts\\SecurityGuardDriverInterface",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  },
                  {
                    "name": "strategy",
                    "type": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Service\\SecurityGuardService",
            "type": "class",
            "methods": [
              {
                "name": "__construct",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "adapter",
                    "type": "Maatify\\DataAdapters\\Contracts\\AdapterInterface"
                  },
                  {
                    "name": "strategy",
                    "type": "Maatify\\SecurityGuard\\Identifier\\Contracts\\IdentifierStrategyInterface"
                  }
                ]
              },
              {
                "name": "recordFailure",
                "visibility": "public",
                "return_type": "int",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO"
                  }
                ]
              },
              {
                "name": "resetAttempts",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getActiveBlock",
                "visibility": "public",
                "return_type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "isBlocked",
                "visibility": "public",
                "return_type": "bool",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "getRemainingBlockSeconds",
                "visibility": "public",
                "return_type": "int|null",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "block",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dto",
                    "type": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO"
                  }
                ]
              },
              {
                "name": "unblock",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "ip",
                    "type": "string"
                  },
                  {
                    "name": "subject",
                    "type": "string"
                  }
                ]
              },
              {
                "name": "cleanup",
                "visibility": "public",
                "return_type": "void",
                "arguments": []
              },
              {
                "name": "getStats",
                "visibility": "public",
                "return_type": "array<string,mixed>",
                "arguments": []
              }
            ]
          }
        ]
      }
    },
    {
      "phase_id": "phase4",
      "title": "Unified Event System Integration",
      "version": "1.0.3",
      "status": "completed",
      "date": "2025-12-10",
      "summary": "Introduced full Security Event System including SecurityEventDTO, event factory, action/platform wrappers, dispatchers, listener interfaces, and event emission in SecurityGuardService and DTOs. Added native, Slim, Laravel examples.",
      "changes": {
        "added": [
          "src/DTO/SecurityEventDTO.php",
          "src/Event/SecurityEventFactory.php",
          "src/Event/SecurityAction.php",
          "src/Event/SecurityPlatform.php",
          "src/Event/Contracts/EventDispatcherInterface.php",
          "src/Event/Contracts/EventListenerInterface.php",
          "src/Event/Dispatcher/SyncDispatcher.php",
          "src/Event/Dispatcher/PsrLoggerDispatcher.php",
          "src/Event/Dispatcher/NullDispatcher.php",
          "src/Enums/SecurityActionEnum.php",
          "src/Enums/SecurityEventTypeEnum.php",
          "src/Enums/SecurityPlatformEnum.php",
          "examples/phase4/native/bootstrap_security_guard.php",
          "examples/phase4/native/login_failed_flow.php",
          "examples/phase4/native/custom_security_event.php",
          "examples/phase4/native/event_sync_dispatcher.php",
          "examples/phase4/native/event_psr_logger_dispatcher.php",
          "examples/phase4/native/admin_block_unblock.php",
          "examples/phase4/native/check_block_status.php",
          "examples/phase4/native/system_operations.php",
          "examples/phase4/native/full_security_flow.php",
          "examples/phase4/slim/slim_middleware_example.php",
          "examples/phase4/laravel/bootstrap_security_guard.php"
        ],
        "updated": [
          "src/Service/SecurityGuardService.php",
          "src/DTO/LoginAttemptDTO.php",
          "src/DTO/SecurityBlockDTO.php",
          "docs/README.full.md",
          "examples/Examples.md",
          "docs/phases/README.phase4.md"
        ],
        "removed": []
      },
      "tests_result": {
        "fake": "pending",
        "real": "pending"
      },
      "coverage": "pending",
      "documentation_files": [
        "docs/phases/README.phase4.md",
        "docs/README.full.md"
      ],
      "commit_metadata": {
        "type": "feat",
        "scope": "event-system",
        "message": "feat: add unified security event system with DTOs, dispatchers, listeners, and service integration",
        "breaking": false
      },
      "git_patch": {
        "generated": true,
        "filename": "phase4.patch",
        "format": "unified"
      },
      "reflection": {
        "only_modified_classes": false,
        "details": [
          {
            "class": "Maatify\\SecurityGuard\\DTO\\LoginAttemptDTO",
            "methods": [
              {
                "name": "toEvent",
                "visibility": "public",
                "return_type": "SecurityEventDTO",
                "arguments": [
                  {
                    "name": "platform",
                    "type": "SecurityPlatform"
                  },
                  {
                    "name": "userId",
                    "type": "int|null"
                  },
                  {
                    "name": "userType",
                    "type": "string|null"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\DTO\\SecurityBlockDTO",
            "methods": [
              {
                "name": "toCreatedEvent",
                "visibility": "public",
                "return_type": "SecurityEventDTO",
                "arguments": [
                  {
                    "name": "platform",
                    "type": "SecurityPlatform"
                  },
                  {
                    "name": "userId",
                    "type": "int|null"
                  },
                  {
                    "name": "userType",
                    "type": "string|null"
                  }
                ]
              },
              {
                "name": "toRemovedEvent",
                "visibility": "public",
                "return_type": "SecurityEventDTO",
                "arguments": [
                  {
                    "name": "platform",
                    "type": "SecurityPlatform"
                  },
                  {
                    "name": "userId",
                    "type": "int|null"
                  },
                  {
                    "name": "userType",
                    "type": "string|null"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Service\\SecurityGuardService",
            "methods": [
              {
                "name": "setEventDispatcher",
                "visibility": "public",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "dispatcher",
                    "type": "EventDispatcherInterface"
                  }
                ]
              },
              {
                "name": "dispatchEvent",
                "visibility": "private",
                "return_type": "void",
                "arguments": [
                  {
                    "name": "event",
                    "type": "SecurityEventDTO"
                  }
                ]
              }
            ]
          },
          {
            "class": "Maatify\\SecurityGuard\\Event\\SecurityEventFactory",
            "methods": [
              {
                "name": "fromLoginAttempt",
                "visibility": "public"
              },
              {
                "name": "blockCreated",
                "visibility": "public"
              },
              {
                "name": "blockRemoved",
                "visibility": "public"
              },
              {
                "name": "cleanup",
                "visibility": "public"
              },
              {
                "name": "custom",
                "visibility": "public"
              }
            ]
          }
        ]
      }
    }
  ]
}
